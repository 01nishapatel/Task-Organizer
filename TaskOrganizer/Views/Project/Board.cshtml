@using Database
@model IEnumerable<Database.Task>
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
@using Microsoft.AspNetCore.Http
@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor
@using Microsoft.EntityFrameworkCore;

@{
    ViewData["Title"] = "Board";

}
<!DOCTYPE html>
<html lang="en">
<head>
    <title>@ViewData["Title"] - Task Organizer</title>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="keywords" content="" />
    <meta name="author" content="" />
    <meta name="robots" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Workload : Workload Project Management Admin  Bootstrap 5 Template" />
    <meta property="og:title" content="Workload : Workload Project Management Admin  Bootstrap 5 Template" />
    <meta property="og:description" content="Workload : Workload Project Management Admin  Bootstrap 5 Template" />
    <meta property="og:image" content="https:/workload.dexignlab.com/xhtml/social-image.png" />
    <meta name="format-detection" content="telephone=no">

    <!-- PAGE TITLE HERE -->
    @*<title>Task Organizer</title>*@

    <!-- FAVICONS ICON -->
    <link rel="shortcut icon" type="image/png" href="~/Contents/images/favicon.ico" />
    <link href="~/Contents/vendor/jquery-nice-select/css/nice-select.css" rel="stylesheet">
    <link href="~/Contents/vendor/owl-carousel/owl.carousel.css" rel="stylesheet">
    <link rel="stylesheet" href="~/Contents/vendor/nouislider/nouislider.min.css">

    <style>


        .AvatarPhoto--color4.AvatarPhoto {
            background-color: forestgreen;
            color: white;
        }

        .ProfilePageHeader-avatar {
            flex-shrink: 0;
        }

        .Avatar {
            align-items: center;
            background: lightGray;
            border-radius: 50%;
            box-shadow: inset 0 0 0 1px rgb(0 0 0 / 7%);
            box-sizing: border-box;
            color: #fff;
            -webkit-print-color-adjust: exact;
            color-adjust: exact;
            display: inline-flex;
            justify-content: center;
            position: relative;
            vertical-align: top;
        }

        .AvatarPhoto--xlarge {
            font-size: 16px;
            height: 48px;
            line-height: 48px;
            min-width: 48px;
            width: 48px;
        }

        .AvatarPhoto--default {
            background: center/cover var(--color-customization-background-deprecated-opaque);
            border-radius: 50%;
            box-shadow: inset 0 0 0 1px rgb(0 0 0 / 7%);
            box-sizing: border-box;
            color: var(--color-customization-foreground);
        }

        .AvatarPhoto {
            align-items: center;
            display: inline-flex;
            justify-content: center;
            position: relative;
            vertical-align: top;
        }

    </style>

    <!-- Style css -->
    <link href="~/Contents/css/style.css" rel="stylesheet">

</head>
<body>

    <!--*******************
        Preloader start
    ********************-->
    <div id="preloader">
        <div class="lds-ripple">
            <div></div>
            <div></div>
        </div>
    </div>
    <!--*******************
        Preloader end
    ********************-->
    <!--**********************************
        Main wrapper start
    ***********************************-->
    @*<div id="main-wrapper">*@

    <div class="nav-header">
        <a href="~/Project/AllProject" class="brand-logo">
            <svg class="logo-abbr" width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect class="react-logo" width="60" height="60" rx="30" fill="#00A15D" />

                <mask id="mask0" style="mask:alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="60" height="60">
                    <rect class="react-logo" width="60" height="60" rx="30" fill="#00A15D" />
                </mask>
                <g mask="url(#mask0)">
                    <path d="M130 51.3929L126.5 45.2109C123 38.9626 116 26.6981 109 23.1017C102 19.5715 95 24.875 88 29.3002C81 33.6591 74 37.3053 67 39.0124C60 40.7857 53 40.7857 46 36.3606C39 32.0017 32 23.0519 25 17.7981C18 12.4448 11 10.7874 4 16.9197C-3 23.0519 -10 37.3053 -17 40.7857C-24 44.2662 -31 37.3053 -34.5 33.7088L-38 30.1786V62H-34.5C-31 62 -24 62 -17 62C-10 62 -3 62 4 62C11 62 18 62 25 62C32 62 39 62 46 62C53 62 60 62 67 62C74 62 81 62 88 62C95 62 102 62 109 62C116 62 123 62 126.5 62H130V51.3929Z" fill="url(#paint0_linear)" />
                    <path d="M-54 55.7741L-50.5 50.9799C-47 46.1343 -40 36.623 -33 33.8339C-26 31.0962 -19 35.2092 -12 38.641C-5 42.0213 2 44.849 9 46.1728C16 47.5481 23 47.5481 30 44.1164C37 40.736 44 33.7954 51 29.721C58 25.5694 65 24.2841 72 29.0398C79 33.7954 86 44.849 93 47.5481C100 50.2473 107 44.849 110.5 42.0599L114 39.3222V64H110.5C107 64 100 64 93 64C86 64 79 64 72 64C65 64 58 64 51 64C44 64 37 64 30 64C23 64 16 64 9 64C2 64 -5 64 -12 64C-19 64 -26 64 -33 64C-40 64 -47 64 -50.5 64H-54V55.7741Z" fill="url(#paint1_linear)" />
                </g>
                <defs>
                    <linearGradient id="paint0_linear" x1="46" y1="13" x2="46" y2="62" gradientUnits="userSpaceOnUse">
                        <stop offset="0" stop-color="#23D58A" />
                        <stop offset="1" stop-color="#00A15D" />
                    </linearGradient>
                    <linearGradient id="paint1_linear" x1="30" y1="26" x2="30" y2="64" gradientUnits="userSpaceOnUse">
                        <stop offset="0" stop-color="#FFED4B" />
                        <stop offset="1" stop-color="#FF8C4B" />
                    </linearGradient>
                </defs>
            </svg>

            <div class="brand-title">
                <h2 class=""><span>Task</span>Organizer</h2>
                <span class="brand-sub-title">Arrange Ur Task</span>
            </div>
        </a>
        <div class="nav-control">
            <div class="hamburger">
                <span class="line"></span><span class="line"></span><span class="line"></span>
            </div>
        </div>
    </div>
    <!--**********************************
        Nav header end
    ***********************************-->
    <!--**********************************
        Header start
    ***********************************-->
    <div class="header border-bottom">
        <div class="header-content">
            <nav class="navbar navbar-expand">
                <div class="collapse navbar-collapse justify-content-between">
                    <div class="header-left">
                        <div class="dashboard_bar">
                            @ViewData["headertitle"]
                        </div>
                    </div>
                    <ul class="navbar-nav header-right">
                        <li class="nav-item dropdown header-profile">
                            <a class="nav-link" role="button" data-bs-toggle="dropdown">
                                <div class="ProfilePageHeader-avatar Avatar AvatarPhoto AvatarPhoto--default AvatarPhoto--xlarge AvatarPhoto--color4" role="img">
                                    <div aria-hidden="true">
                                        @HttpContextAccessor.HttpContext.Session.GetString("labelname")
                                    </div>
                                </div>
                                <div class="header-info ms-3">
                                    <span class="fs-18 font-w500 mb-2">@HttpContextAccessor.HttpContext.Session.GetString("UserName")</span>
                                    <small class="fs-12 font-w400">@HttpContextAccessor.HttpContext.Session.GetString("UserEmail")</small>
                                </div>
                            </a>
                            <div class="dropdown-menu dropdown-menu-end">
                                <a class="dropdown-item ai-icon" asp-action="UserProfile" asp-controller="Account" asp-route-id="@HttpContextAccessor.HttpContext.Session.GetInt32("UserId")">
                                    <svg id="icon-user1" class="text-primary" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                                    <span class="ms-2">Profile </span>
                                </a>
                                <a class="dropdown-item ai-icon" onclick="Logout()">
                                    <svg id="icon-logout" class="text-danger" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
                                    <span class="ms-2">Logout </span>
                                </a>
                            </div>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
    </div>
    <!--**********************************
        Header end
    ***********************************-->
    <!--**********************************
        Sidebar start
    ***********************************-->
    <div class="dlabnav">
        <div class="dlabnav-scroll">
            <ul class="metismenu" id="menu">

                @{
                    var s = @HttpContextAccessor.HttpContext.Session.GetInt32("UserType");
                    var ad = @HttpContextAccessor.HttpContext.Session.GetString("isAd");
                }
                @if (ad == "True")
                {
                    @if (@ViewData["Title"] == "AllMember" || @ViewData["Title"] == "UserDashBoard")
                    {
                        <li>
                            <a class="has-arrow " href="javascript:void()" aria-expanded="false">
                                <i class="fas fa-users"></i>
                                <span class="nav-text">Members</span>
                            </a>
                            <ul aria-expanded="false">
                                <li><a asp-controller="Account" asp-action="AllMember" asp-route-id="@HttpContextAccessor.HttpContext.Session.GetInt32("projjid")">All Member</a></li>
                                <li><a asp-controller="Account" asp-action="AddMember" asp-route-id="@HttpContextAccessor.HttpContext.Session.GetInt32("projjid")">Add Member</a></li>
                            </ul>
                        </li>
                        <li>
                            <a href="~/Task/AddTask" class="" aria-expanded="false">
                                <i class="fas fa-check"></i>
                                <span class="nav-text">Add Task</span>
                            </a>
                        </li>
                    }
                    <li>
                        <a class="has-arrow " href="javascript:void()" aria-expanded="false">
                            <i class="fas fa-users"></i>
                            <span class="nav-text">Users</span>
                        </a>
                        <ul aria-expanded="false">
                            <li><a href="~/Account/AllUser">All User</a></li>
                            <li><a href="~/Account/Register">Add User</a></li>


                        </ul>
                    </li>
                    <li>
                        <a href="~/Project/AllProject" class="" aria-expanded="false">
                            <i class="fas fa-clone"></i>
                            <span class="nav-text">All Project</span>
                        </a>
                    </li>
                    <li>
                        <a asp-controller="Project" asp-action="AdminCalender" aria-expanded="false">
                            <i class="fas fa-calendar"></i>
                            <span class="nav-text">Calendar</span>
                        </a>
                    </li>
                }
                else
                {
                    @if (s == 0 || s == 1 || s == 2)
                    {
                        if (@ViewData["Title"] != "AllProject")
                        {
                            <li>
                                <a class="has-arrow " href="javascript:void()" aria-expanded="false">
                                    <i class="fas fa-tasks"></i>
                                    <span class="nav-text">Project</span>
                                </a>
                                <ul aria-expanded="false">
                                    <li><a asp-controller="Project" asp-action="Board" asp-route-id="@HttpContextAccessor.HttpContext.Session.GetInt32("ProjId")">Board</a></li>
                                    <li><a asp-controller="Project" asp-action="UserDashBoard" asp-route-id="@HttpContextAccessor.HttpContext.Session.GetInt32("ProjId")" asp-route-uid="@HttpContextAccessor.HttpContext.Session.GetInt32("UserId")">DashBoard</a></li>
                                </ul>

                            </li>
                            <li>
                                <a asp-controller="Project" asp-action="Calender" asp-route-id="@HttpContextAccessor.HttpContext.Session.GetInt32("ProjId")" aria-expanded="false">
                                    <i class="fas fa-calendar"></i>
                                    <span class="nav-text">Calendar</span>
                                </a>
                            </li>
                            @if (s != 2)
                            {
                                <li>
                                    <a href="~/Task/AddTask" class="" aria-expanded="false">
                                        <i class="fas fa-check"></i>
                                        <span class="nav-text">Add Task</span>
                                    </a>
                                </li>
                            }
                        }
                    }
                    <li>
                        <a href="~/Project/AllProject" class="" aria-expanded="false">
                            <i class="fas fa-clone"></i>
                            <span class="nav-text">All Project</span>
                        </a>
                    </li>
                }
            </ul>
        </div>
    </div>

    <!--*******************************
        Main wrapper start
    ***********************************-->

    <div id="main-wrapper">


        <!--**********************************
            Content body start
        ***********************************-->
        <div class="content-body">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-xl-12">
                        <div class="row">
                            <div class="col-xl-12">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-xl-6">

                                                <h4 class="fs-32 font-w700">@HttpContextAccessor.HttpContext.Session.GetString("ProjName") </h4>
                                                @{
                                                    DateTime pdate = Convert.ToDateTime(@HttpContextAccessor.HttpContext.Session.GetString("SDate"));
                                                }
                                                <span class="mb-2 d-block">@pdate.ToLongDateString()</span>
                                            </div>
                                            <div class="col-xl-3">

                                                <div class="nav-item header-right">
                                                    <form method="get" asp-controller="Project" asp-action="Board">
                                                        <div class="input-group search-area">
                                                            <input type="Search" data-bs-container="body" data-theme="" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-content="search Task by TaskTitle,task Priority,Task Type and description.." class="form-control" name="search" placeholder="Search here..." />
                                                            <span class="input-group-text"><button style="border:0;size:20px;color:gray" type="submit" asp-controller="Project" asp-action="Board"><i class="flaticon-381-search-2"></i></button></span>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                            <div class="col-xl-3">
                                                <div class="nav-item">

                                                    @if (s != 2)
                                                    {
                                                        <button type="button" onclick="location.href='@Url.Action("AddTask","Task")'" class="btn btn-primary btn-rounded">+Add Task</button>
                                                    }
                                                </div>

                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row kanban-bx">
                    <div class="col">
                        <div class="kanbanPreview-bx">
                            <div class="draggable-zone dropzoneContainer Pending">

                                <div class="sub-card align-items-center d-flex justify-content-between mb-4">
                                    <div>
                                        <h4 class="fs-20 mb-0 font-w600">Pending (<span class="totalCount"></span>)</h4>
                                    </div>
                                    <div class="plus-bx">
                                        <a href="javascript:void(0)"><i class="fas fa-plus"></i></a>
                                    </div>
                                </div>

                                @foreach (var obj1 in Model)
                                {
                                    @if (@obj1.Status == Database.Status.Pending)
                                    {

                                        var dueDate = (@obj1.EndDate - @DateTime.Now);

                                        <div class="card draggable-handle draggable" id="@obj1.TaskID">
                                            <div class="card-body">
                                                @*<div class="d-flex justify-content-between mb-2" onclick="location.href='@Url.Action("TaskDetail","Task")'">*@
                                                <!--Task Title-->
                                                <div class="d-flex justify-content-between mb-2">
                                                    <span class="text-title" style="color:#D653C1">
                                                        <svg class="me-2" width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                            <circle cx="5" cy="5" r="5" fill="#D653C1" />
                                                        </svg>
                                                        @obj1.TaskType
                                                    </span>

                                                    <!--dropdown for Edit and delete-->
                                                    <div class="dropdown">
                                                        <div class="btn-link" data-bs-toggle="dropdown">
                                                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                <circle cx="3.5" cy="11.5" r="2.5" transform="rotate(-90 3.5 11.5)" fill="#717579" />
                                                                <circle cx="11.5" cy="11.5" r="2.5" transform="rotate(-90 11.5 11.5)" fill="#717579" />
                                                                <circle cx="19.5" cy="11.5" r="2.5" transform="rotate(-90 19.5 11.5)" fill="#717579" />
                                                            </svg>
                                                        </div>
                                                        <div class="dropdown-menu dropdown-menu-right">
                                                            <a class="dropdown-item" onclick="return confirm('Do ypu want to delete this Task : @obj1.TaskTitle')" asp-controller="Task" asp-action="DeleteTask" asp-route-id="@obj1.TaskID">Delete</a>
                                                            <a class="dropdown-item" asp-controller="Task" asp-action="TaskDetail" asp-route-id="@obj1.TaskID">Edit</a>

                                                        </div>
                                                    </div>
                                                </div>
                                                <!--Progress bar-->
                                                <p class="font-w600 fs-18"><a href="javascript:void(0);" class="text-black">@obj1.TaskTitle :</a></p>
                                                <p class="font-w600 fs-16"><a href="javascript:void(0);" class="text-greay">@obj1.Description</a></p>

                                                <div class="row justify-content-between align-items-center kanban-user">
                                                    <div class="col-4 d-flex justify-content-start">
                                                        <span class="badge badge-secondary">@obj1.Priority</span>
                                                    </div>

                                                    <div class="col-8 d-flex justify-content-end">
                                                        @if (dueDate.GetValueOrDefault().Days <= 0)
                                                        {
                                                            var a = @Math.Abs(dueDate.GetValueOrDefault().Days);
                                                            <span class="fs-14" style="color:red"><i class="far fa-clock me-s2"></i>Over Due from @a Days</span>
                                                        }
                                                        else
                                                        {
                                                            <span class="fs-14"><i class="far fa-clock me-2"></i>Due in @dueDate.GetValueOrDefault().Days Days</span>
                                                        }
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                }
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="kanbanPreview-bx">
                            <div class="draggable-zone dropzoneContainer Inprogess">
                                <div class="sub-card align-items-center d-flex justify-content-between mb-4">
                                    <div>
                                        <h4 class="fs-20 mb-0 font-w600">In Progress(<span class="totalCount"></span>)</h4>
                                    </div>
                                    <div class="plus-bx">
                                        <a href="javascript:void(0)"><i class="fas fa-plus"></i></a>
                                    </div>
                                </div>
                                @foreach (var obj2 in Model)
                                {
                                    @if (@obj2.Status == Database.Status.Inprogess)
                                    {
                                        var dueDate = (@obj2.EndDate - @DateTime.Now);

                                        <div class="card draggable-handle draggable" id="@obj2.TaskID">

                                            <div class="card-body">
                                                <!--Task Title-->
                                                <div class="d-flex justify-content-between mb-2" data-bs-toggle="modal" data-bs-target=".bd-example-modal-lg2">
                                                    <span class="text-title" style="color:#FFCF6D">
                                                        <svg class="me-2" width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                            <circle cx="5" cy="5" r="5" fill="#FFCF6D" />
                                                        </svg>
                                                        @obj2.TaskType
                                                    </span>


                                                    <!--dropdown for Edit and delete-->
                                                    <div class="dropdown">
                                                        <div class="btn-link" data-bs-toggle="dropdown">
                                                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                <circle cx="3.5" cy="11.5" r="2.5" transform="rotate(-90 3.5 11.5)" fill="#717579" />
                                                                <circle cx="11.5" cy="11.5" r="2.5" transform="rotate(-90 11.5 11.5)" fill="#717579" />
                                                                <circle cx="19.5" cy="11.5" r="2.5" transform="rotate(-90 19.5 11.5)" fill="#717579" />
                                                            </svg>
                                                        </div>
                                                        <div class="dropdown-menu dropdown-menu-right">
                                                            <a class="dropdown-item" onclick="return confirm('Do ypu want to delete this Task : @obj2.TaskTitle')" asp-controller="Task" asp-action="DeleteTask" asp-route-id="@obj2.TaskID">Delete</a>
                                                            <a class="dropdown-item" asp-controller="Task" asp-action="TaskDetail" asp-route-id="@obj2.TaskID">Edit</a>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!--Progress bar-->
                                                <p class="font-w600 fs-18"><a href="javascript:void(0);" class="text-black">@obj2.TaskTitle :</a></p>
                                                <p class="font-w600 fs-16"><a href="javascript:void(0);" class="text-greay">@obj2.Description</a></p>

                                                <div class="row justify-content-between align-items-center kanban-user">
                                                    <div class="col-4 d-flex justify-content-start">
                                                        <span class="badge badge-secondary">@obj2.Priority</span>
                                                    </div>

                                                    <div class="col-8 d-flex justify-content-end">
                                                        @if (dueDate.GetValueOrDefault().Days <= 0)
                                                        {
                                                            var a = @Math.Abs(dueDate.GetValueOrDefault().Days);
                                                            <span class="fs-14" style="color:red"><i class="far fa-clock me-2"></i>Over Due from @a Days</span>
                                                        }
                                                        else
                                                        {
                                                            <span class="fs-14"><i class="far fa-clock me-2"></i>Due in @dueDate.GetValueOrDefault().Days Days</span>
                                                        }
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                }
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="kanbanPreview-bx">
                            <div class="draggable-zone dropzoneContainer Completed">
                                <div class="sub-card align-items-center d-flex justify-content-between mb-4">
                                    <div>
                                        <h4 class="fs-20 mb-0 font-w600">Completed(<span class="totalCount"></span>)</h4>
                                    </div>
                                    <div class="plus-bx">
                                        <a href="javascript:void(0)"><i class="fas fa-plus"></i></a>
                                    </div>
                                </div>
                                @foreach (var obj3 in Model)
                                {
                                    @if (@obj3.Status == Database.Status.Completed)
                                    {
                                        var dueDate = (@obj3.EndDate - @DateTime.Now);

                                        <div class="card draggable-handle draggable" id="@obj3.TaskID">
                                            <div class="card-body">

                                                <!--Task Title-->
                                                <div class="d-flex justify-content-between mb-2">
                                                    <span class="text-title" style="color:#09BD3C">
                                                        <svg class="me-2" width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                            <circle cx="5" cy="5" r="5" fill="#09BD3C" />
                                                        </svg>
                                                        @obj3.TaskType
                                                    </span>

                                                    <!--dropdown for Edit and delete-->
                                                    <div class="dropdown">
                                                        <div class="btn-link" data-bs-toggle="dropdown">
                                                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                <circle cx="3.5" cy="11.5" r="2.5" transform="rotate(-90 3.5 11.5)" fill="#717579" />
                                                                <circle cx="11.5" cy="11.5" r="2.5" transform="rotate(-90 11.5 11.5)" fill="#717579" />
                                                                <circle cx="19.5" cy="11.5" r="2.5" transform="rotate(-90 19.5 11.5)" fill="#717579" />
                                                            </svg>
                                                        </div>
                                                        <div class="dropdown-menu dropdown-menu-right">
                                                            <a class="dropdown-item" onclick="return confirm('Do ypu want to delete this Task : @obj3.TaskTitle')" asp-controller="Task" asp-action="DeleteTask" asp-route-id="@obj3.TaskID">Delete</a>
                                                            <a class="dropdown-item" asp-controller="Task" asp-action="TaskDetail" asp-route-id="@obj3.TaskID">Edit</a>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!--Progress bar-->
                                                <p class="font-w600 fs-18"><a href="javascript:void(0);" class="text-black">@obj3.TaskTitle :</a></p>
                                                <p class="font-w600 fs-16"><a href="javascript:void(0);" class="text-greay">@obj3.Description</a></p>

                                                <div class="row justify-content-between align-items-center kanban-user">
                                                    <div class="col-4 d-flex justify-content-start">
                                                        <span class="badge badge-secondary">@obj3.Priority</span>
                                                    </div>

                                                    <div class="col-8 d-flex justify-content-end">
                                                        @if (dueDate.GetValueOrDefault().Days <= 0)
                                                        {
                                                            var a = @Math.Abs(dueDate.GetValueOrDefault().Days);
                                                            <span class="fs-14" style="color:red"><i class="far fa-clock me-2"></i>Over Due from @a Days</span>
                                                        }
                                                        else
                                                        {
                                                            <span class="fs-14"><i class="far fa-clock me-2"></i>Due in @dueDate.GetValueOrDefault().Days Days</span>
                                                        }
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                }
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <div class="kanbanPreview-bx">
                            <div class="draggable-zone dropzoneContainer Reassigned">
                                <div class="sub-card align-items-center d-flex justify-content-between mb-4">
                                    <div>
                                        <h4 class="fs-20 mb-0 font-w600">Reassigned(<span class="totalCount"></span>)</h4>
                                    </div>
                                    <div class="plus-bx">
                                        <a href="javascript:void(0)"><i class="fas fa-plus"></i></a>
                                    </div>
                                </div>
                                @foreach (var obj4 in Model)
                                {

                                    @if (@obj4.Status == Database.Status.Reassigned)
                                    {
                                        var dueDate = (@obj4.EndDate - @DateTime.Now);

                                        <div class="card draggable-handle draggable" id="@obj4.TaskID">
                                            <div class="card-body">
                                                <!--Task Title-->
                                                <div class="d-flex justify-content-between mb-2">
                                                    <span class="text-title" style="color:#FC2E53">
                                                        <svg class="me-2" width="10" height="10" viewBox="0 0 10 10" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                            <circle cx="5" cy="5" r="5" fill="#FC2E53" />
                                                        </svg>
                                                        @obj4.TaskType
                                                    </span>

                                                    <!--dropdown for Edit and delete-->
                                                    <div class="dropdown">
                                                        <div class="btn-link" data-bs-toggle="dropdown">
                                                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                <circle cx="3.5" cy="11.5" r="2.5" transform="rotate(-90 3.5 11.5)" fill="#717579" />
                                                                <circle cx="11.5" cy="11.5" r="2.5" transform="rotate(-90 11.5 11.5)" fill="#717579" />
                                                                <circle cx="19.5" cy="11.5" r="2.5" transform="rotate(-90 19.5 11.5)" fill="#717579" />
                                                            </svg>
                                                        </div>
                                                        <div class="dropdown-menu dropdown-menu-right">
                                                            <a class="dropdown-item" onclick="return confirm('Do ypu want to delete this Task : @obj4.TaskTitle')" asp-controller="Task" asp-action="DeleteTask" asp-route-id="@obj4.TaskID">Delete</a>
                                                            <a class="dropdown-item" asp-controller="Task" asp-action="TaskDetail" asp-route-id="@obj4.TaskID">Edit</a>

                                                        </div>
                                                    </div>
                                                </div>
                                                <!--Progress bar-->
                                                <p class="font-w600 fs-18"><a href="javascript:void(0);" class="text-black">@obj4.TaskTitle :</a></p>
                                                <p class="font-w600 fs-16"><a href="javascript:void(0);" class="text-greay">@obj4.Description</a></p>

                                                <div class="row justify-content-between align-items-center kanban-user">
                                                    <div class="col-4 d-flex justify-content-start">
                                                        <span class="badge badge-secondary">@obj4.Priority</span>
                                                    </div>
                                                    <div class="col-8 d-flex justify-content-end">
                                                        @if (dueDate.GetValueOrDefault().Days <= 0)
                                                        {
                                                            var a = @Math.Abs(dueDate.GetValueOrDefault().Days);
                                                            <span class="fs-14" style="color:red"><i class="far fa-clock me-2"></i>Over Due from @a Days</span>
                                                        }
                                                        else
                                                        {
                                                            <span class="fs-14"><i class="far fa-clock me-2"></i>Due in @dueDate.GetValueOrDefault().Days Days</span>
                                                        }
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                }
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--**********************************
            Content body end
        ***********************************-->
    </div>
    <!--**********************************
        Scripts
    ***********************************-->
    <!-- Required vendors -->

    <script src="~/Contents/vendor/global/global.min.js"></script>
    <script src="~/Contents/vendor/jquery-nice-select/js/jquery.nice-select.min.js"></script>

    <script src="~/Contents/vendor/draggable/draggable.js"></script>

    <script type="text/javascript">

        function openSuccessModal(strMessage) {
            var myDiv = document.getElementById("MyModalSuccessAlertBody");
            myDiv.innerHTML = strMessage;
            $('#myModalSuccess').modal('show');
        }

        $(document).ready(function() {

            var msg = "@TempData["SuccessMessage"]";
            if (msg) {
                openSuccessModal(msg);
            }
        });

    </script>
    <script type="text/javascript">
        function Logout() {

            $.get(window.location.origin + "/Account/logout?n=1", null, callback)
        }

        function callback() {
            window.location.reload();
        }
        if (result.code === 1) {
            window.location = 'login.cshtml'
        }

    </script>

    <script>

        function updateTask(status, id) {
            $.ajax(
                {
                    type: "POST",
                    async: false,              // <- note addition
                    url: "/Task/UpdateTaskDetails",
                    data: { 'status': status, "id": id },
                    success: function(result) {

                        //if (result.indb) {
                        //	isvalid = true;

                        //}
                    },
                    error: function(error) {
                        alert(error);
                    }
                });

        }
        var Workload = function() {
            "use strict"
            /* Search Bar ============ */
            var screenWidth = $(window).width();
            var screenHeight = $(window).height();


            var handleNiceSelect = function() {
                if (jQuery('.default-select').length > 0) {
                    jQuery('.default-select').niceSelect();
                }
            }

            var handlePreloader = function() {
                setTimeout(function() {
                    jQuery('#preloader').remove();
                    $('#main-wrapper').addClass('show');
                }, 800);

            }

            var handleMetisMenu = function() {
                if (jQuery('#menu').length > 0) {
                    $("#menu").metisMenu();
                }
                jQuery('.metismenu > .mm-active ').each(function() {
                    if (!jQuery(this).children('ul').length > 0) {
                        jQuery(this).addClass('active-no-child');
                    }
                });
            }

            var handleAllChecked = function() {
                $("#checkAll").on('change', function() {
                    $("td input, .email-list .custom-checkbox input").prop('checked', $(this).prop("checked"));
                });
            }

            var handleNavigation = function() {
                $(".nav-control").on('click', function() {

                    $('#main-wrapper').toggleClass("menu-toggle");

                    $(".hamburger").toggleClass("is-active");
                });
            }

            var handleCurrentActive = function() {
                for (var nk = window.location,
                    o = $("ul#menu a").filter(function() {

                        return this.href == nk;

                    })
                        .addClass("mm-active")
                        .parent()
                        .addClass("mm-active"); ;) {

                    if (!o.is("li")) break;

                    o = o.parent()
                        .addClass("mm-show")
                        .parent()
                        .addClass("mm-active");
                }
            }

            var handleMiniSidebar = function() {
                $("ul#menu>li").on('click', function() {
                    const sidebarStyle = $('body').attr('data-sidebar-style');
                    if (sidebarStyle === 'mini') {
                        console.log($(this).find('ul'))
                        $(this).find('ul').stop()
                    }
                })
            }

            var handleMinHeight = function() {
                var win_h = window.outerHeight;
                var win_h = window.outerHeight;
                if (win_h > 0 ? win_h : screen.height) {
                    $(".content-body").css("min-height", (win_h + 60) + "px");
                };
            }

            var handleDataAction = function() {
                $('a[data-action="collapse"]').on("click", function(i) {
                    i.preventDefault(),
                        $(this).closest(".card").find('[data-action="collapse"] i').toggleClass("mdi-arrow-down mdi-arrow-up"),
                        $(this).closest(".card").children(".card-body").collapse("toggle");
                });

                $('a[data-action="expand"]').on("click", function(i) {
                    i.preventDefault(),
                        $(this).closest(".card").find('[data-action="expand"] i').toggleClass("icon-size-actual icon-size-fullscreen"),
                        $(this).closest(".card").toggleClass("card-fullscreen");
                });



                $('[data-action="close"]').on("click", function() {
                    $(this).closest(".card").removeClass().slideUp("fast");
                });

                $('[data-action="reload"]').on("click", function() {
                    var e = $(this);
                    e.parents(".card").addClass("card-load"),
                        e.parents(".card").append('<div class="card-loader"><i class=" ti-reload rotate-refresh"></div>'),
                        setTimeout(function() {
                            e.parents(".card").children(".card-loader").remove(),
                                e.parents(".card").removeClass("card-load")
                        }, 2000)
                });
            }

            var handleHeaderHight = function() {
                const headerHight = $('.header').innerHeight();
                $(window).scroll(function() {
                    if ($('body').attr('data-layout') === "horizontal" && $('body').attr('data-header-position') === "static" && $('body').attr('data-sidebar-position') === "fixed")
                        $(this.window).scrollTop() >= headerHight ? $('.dlabnav').addClass('fixed') : $('.dlabnav').removeClass('fixed')
                });
            }

            var handleDzScroll = function() {
                jQuery('.dlab-scroll').each(function() {
                    var scroolWidgetId = jQuery(this).attr('id');
                    const ps = new PerfectScrollbar('#' + scroolWidgetId, {
                        wheelSpeed: 2,
                        wheelPropagation: true,
                        minScrollbarLength: 20
                    });
                    ps.isRtl = false;
                })
            }

            var handleMenuTabs = function() {
                if (screenWidth <= 991) {
                    jQuery('.menu-tabs .nav-link').on('click', function() {
                        if (jQuery(this).hasClass('open')) {
                            jQuery(this).removeClass('open');
                            jQuery('.fixed-content-box').removeClass('active');
                            jQuery('.hamburger').show();
                        } else {
                            jQuery('.menu-tabs .nav-link').removeClass('open');
                            jQuery(this).addClass('open');
                            jQuery('.fixed-content-box').addClass('active');
                            jQuery('.hamburger').hide();
                        }
                        //jQuery('.fixed-content-box').toggleClass('active');
                    });
                    jQuery('.close-fixed-content').on('click', function() {
                        jQuery('.fixed-content-box').removeClass('active');
                        jQuery('.hamburger').removeClass('is-active');
                        jQuery('#main-wrapper').removeClass('menu-toggle');
                        jQuery('.hamburger').show();
                    });
                }
            }

            var handleChatbox = function() {
                jQuery('.bell-link').on('click', function() {
                    jQuery('.chatbox').addClass('active');
                });
                jQuery('.chatbox-close').on('click', function() {
                    jQuery('.chatbox').removeClass('active');
                });
            }

            var handlePerfectScrollbar = function() {
                if (jQuery('.dlabnav-scroll').length > 0) {
                    //const qs = new PerfectScrollbar('.dlabnav-scroll');
                    const qs = new PerfectScrollbar('.dlabnav-scroll');

                    qs.isRtl = false;
                }
            }

            var handleBtnNumber = function() {
                $('.btn-number').on('click', function(e) {
                    e.preventDefault();

                    fieldName = $(this).attr('data-field');
                    type = $(this).attr('data-type');
                    var input = $("input[name='" + fieldName + "']");
                    var currentVal = parseInt(input.val());
                    if (!isNaN(currentVal)) {
                        if (type == 'minus')
                            input.val(currentVal - 1);
                        else if (type == 'plus')
                            input.val(currentVal + 1);
                    } else {
                        input.val(0);
                    }
                });
            }

            var handleDzChatUser = function() {
                jQuery('.dlab-chat-user-box .dlab-chat-user').on('click', function() {
                    jQuery('.dlab-chat-user-box').addClass('d-none');
                    jQuery('.dlab-chat-history-box').removeClass('d-none');
                    //$(".chatbox .msg_card_body").height(vHeightArea());
                    //$(".chatbox .msg_card_body").css('height',vHeightArea());
                });

                jQuery('.dlab-chat-history-back').on('click', function() {
                    jQuery('.dlab-chat-user-box').removeClass('d-none');
                    jQuery('.dlab-chat-history-box').addClass('d-none');
                });

                jQuery('.dlab-fullscreen').on('click', function() {
                    jQuery('.dlab-fullscreen').toggleClass('active');
                });

                /* var vHeight = function(){ */

                /* } */


            }


            var handleDzFullScreen = function() {
                jQuery('.dlab-fullscreen').on('click', function(e) {
                    if (document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement) {
                        /* Enter fullscreen */
                        if (document.exitFullscreen) {
                            document.exitFullscreen();
                        } else if (document.msExitFullscreen) {
                            document.msExitFullscreen(); /* IE/Edge */
                        } else if (document.mozCancelFullScreen) {
                            document.mozCancelFullScreen(); /* Firefox */
                        } else if (document.webkitExitFullscreen) {
                            document.webkitExitFullscreen(); /* Chrome, Safari & Opera */
                        }
                    }
                    else { /* exit fullscreen */
                        if (document.documentElement.requestFullscreen) {
                            document.documentElement.requestFullscreen();
                        } else if (document.documentElement.webkitRequestFullscreen) {
                            document.documentElement.webkitRequestFullscreen();
                        } else if (document.documentElement.mozRequestFullScreen) {
                            document.documentElement.mozRequestFullScreen();
                        } else if (document.documentElement.msRequestFullscreen) {
                            document.documentElement.msRequestFullscreen();
                        }
                    }
                });
            }

            var handleshowPass = function() {
                jQuery('.show-pass').on('click', function() {
                    jQuery(this).toggleClass('active');
                    if (jQuery('#dlab-password').attr('type') == 'password') {
                        jQuery('#dlab-password').attr('type', 'text');
                    } else if (jQuery('#dlab-password').attr('type') == 'text') {
                        jQuery('#dlab-password').attr('type', 'password');
                    }
                });
            }

            var heartBlast = function() {
                $(".heart").on("click", function() {
                    $(this).toggleClass("heart-blast");
                });
            }

            var handleDzLoadMore = function() {
                $(".dlab-load-more").on('click', function(e) {
                    e.preventDefault();	//STOP default action
                    $(this).append(' <i class="fas fa-sync"></i>');

                    var dlabLoadMoreUrl = $(this).attr('rel');
                    var dlabLoadMoreId = $(this).attr('id');

                    $.ajax({
                        method: "POST",
                        url: dlabLoadMoreUrl,
                        dataType: 'html',
                        success: function(data) {
                            $("#" + dlabLoadMoreId + "Content").append(data);
                            $('.dlab-load-more i').remove();
                        }
                    })
                });
            }

            var handleLightgallery = function() {
                if (jQuery('#lightgallery').length > 0) {
                    $('#lightgallery').lightGallery({
                        loop: true,
                        thumbnail: true,
                        exThumbImage: 'data-exthumbimage'
                    });
                }
            }
            var handleCustomFileInput = function() {
                $(".custom-file-input").on("change", function() {
                    var fileName = $(this).val().split("\\").pop();
                    $(this).siblings(".custom-file-label").addClass("selected").html(fileName);
                });
            }

            var vHeight = function() {
                var ch = $(window).height() - 206;
                $(".chatbox .msg_card_body").css('height', ch);
            }


            var handleDatetimepicker = function() {
                if (jQuery("#datetimepicker1").length > 0) {
                    $('#datetimepicker1').datetimepicker({
                        inline: true,
                    });
                }
            }

            var handleCkEditor = function() {
                if (jQuery("#ckeditor").length > 0) {
                    ClassicEditor
                        .create(document.querySelector('#ckeditor'), {
                            // toolbar: [ 'heading', '|', 'bold', 'italic', 'link' ]
                        })
                        .then(editor => {
                            window.editor = editor;
                        })
                        .catch(err => {
                            console.error(err.stack);
                        });
                }
            }

            var handleMenuPosition = function() {

                if (screenWidth > 1024) {
                    $(".metismenu  li").unbind().each(function(e) {
                        if ($('ul', this).length > 0) {
                            var elm = $('ul:first', this).css('display', 'block');
                            var off = elm.offset();
                            var l = off.left;
                            var w = elm.width();
                            var elm = $('ul:first', this).removeAttr('style');
                            var docH = $("body").height();
                            var docW = $("body").width();

                            if (jQuery('html').hasClass('rtl')) {
                                var isEntirelyVisible = (l + w <= docW);
                            } else {
                                var isEntirelyVisible = (l > 0) ? true : false;
                            }

                            if (!isEntirelyVisible) {
                                $(this).find('ul:first').addClass('left');
                            } else {
                                $(this).find('ul:first').removeClass('left');
                            }
                        }
                    });
                }
            }

            var handleDraggableCard = function(e) {
                var dzCardDraggable = function() {
                    return {
                        //main function to initiate the module
                        init: function() {
                            var containers = document.querySelectorAll('.draggable-zone');

                            if (containers.length === 0) {
                                return false;
                            }

                            var swappable = new Sortable.default(containers, {
                                draggable: '.draggable',
                                handle: '.draggable.draggable-handle',
                                mirror: {
                                    appendTo: 'body',
                                    constrainDimensions: true
                                }

                            });
                            swappable.on('drag:start', (e) => {
                                setTimeout(function(event) {
                                    setBoxCount();
                                }, 200);

                            })
                            swappable.on('drag:stop', (e) => {
                                setTimeout(function(event) {
                                    let status = '';
                                    let id = e.originalSource.id;
                                    if (e.data.originalSource.parentNode.classList.contains("Pending")) {
                                        status = "Pending";
                                    }
                                    if (e.data.originalSource.parentNode.classList.contains("Inprogess")) {
                                        status = "Inprogess";
                                    }
                                    if (e.data.originalSource.parentNode.classList.contains("Completed")) {
                                        status = "Completed";
                                    }
                                    if (e.data.originalSource.parentNode.classList.contains("Reassigned")) {
                                        status = "Reassigned";
                                    }
                                    updateTask(status, id);
                                }, 200);


                            })

                        }
                    };
                }();

                jQuery(document).ready(function() {
                    dzCardDraggable.init();
                });


                function setBoxCount() {
                    var cardCount = 0;
                    jQuery('.dropzoneContainer').each(function() {
                        cardCount = jQuery(this).find('.draggable-handle').length;
                        jQuery(this).find('.totalCount').html(cardCount);
                    });
                }


            }
            /* Function ============ */
            return {
                init: function() {
                    handleMetisMenu();
                    handleAllChecked();
                    handleNavigation();
                    handleCurrentActive();
                    handleMiniSidebar();
                    handleMinHeight();
                    handleDataAction();
                    handleHeaderHight();
                    handleDzScroll();
                    handleMenuTabs();
                    handleChatbox();
                    handlePerfectScrollbar();
                    handleBtnNumber();
                    handleDzChatUser();
                    handleDzFullScreen();
                    handleshowPass();
                    heartBlast();
                    handleDzLoadMore();
                    handleLightgallery();
                    handleCustomFileInput();
                    vHeight();
                    handleDatetimepicker();
                    handleCkEditor();
                    handleDraggableCard();
                },


                load: function() {
                    handlePreloader();
                    handleNiceSelect();
                },

                resize: function() {
                    vHeight();

                },

                handleMenuPosition: function() {

                    handleMenuPosition();
                },
            }

        }();

        /* Document.ready Start */
        jQuery(document).ready(function() {
            $('[data-bs-toggle="popover"]').popover();
            'use strict';
            Workload.init();

        });
        /* Document.ready END */

        /* Window Load START */
        jQuery(window).on('load', function() {
            'use strict';
            Workload.load();
            setTimeout(function() {
                Workload.handleMenuPosition();
            }, 1000);

        });
        /*  Window Load END */
        /* Window Resize START */
        jQuery(window).on('resize', function() {
            'use strict';
            Workload.resize();
            setTimeout(function() {
                Workload.handleMenuPosition();
            }, 1000);
        });
        /*  Window Resize END */
        variables


    </script>


    <script src="~/Contents/js/dlabnav-init.js"></script>






</body>
</html>